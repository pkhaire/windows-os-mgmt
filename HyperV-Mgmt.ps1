Get-Command –Module Hyper-V

################################################################################################################################################################################

# Get HOST name of Virtual Machine.

(get-item "HKLM:\SOFTWARE\Microsoft\Virtual Machine\Guest\Parameters").GetValue("HostName")

################################################################################################################################################################################

# Install Hyper-V Tools feature and PowerShell.

Install-WindowsFeature Hyper-V-Tools

Install-WindowsFeature Hyper-V-PowerShell

Add-WindowsFeature RSAT-Hyper-V-Tools –IncludeAllSubFeature

################################################################################################################################################################################

# Dismount a disk image. It will dismount either an ISO or a virtual hard disk. Specify the path then using -imagepath. 

Dismount-DiskImage -imagepath “C:\fso\myisodisk.iso”

################################################################################################################################################################################

# Disconnect virtual disk

Disconnect-VirtualDisk -FriendlyName VirtualDisk01

################################################################################################################################################################################

New-VM –Name “Ubuntu 10.04” –MemoryStartupBytes 512MB –NewVHDPath C:\VM\ubuntu1004.vhdx –NewVHDSizeBytes 10GB 

################################################################################################################################################################################

Start-VM –Name “Ubuntu Server 2”

################################################################################################################################################################################

Stop-VM –Name “Ubuntu Server 2” 

################################################################################################################################################################################

Get-VM –Name “Ubuntu Server 2”

################################################################################################################################################################################

Add-VMDvdDrive -VMName “Ubuntu Server 2” –Path C:ISOubuntu-10.04.4-server-i386.iso

################################################################################################################################################################################

New-VMSwitch –Name “VMNetwork” –NetAdapterName “Wi-Fi”

New-VMSwitch –Name “VMNetwork” –SwitchType Private

################################################################################################################################################################################
Remove-VMNetworkAdapter -VMName “Ubuntu Server 2” -VMNetworkAdapterName “NIC0”

################################################################################################################################################################################

Connect-VMNetworkAdapter-VMName“Ubuntu Server 2” -Name “NIC0” -SwitchName“VMNetwork”

################################################################################################################################################################################

# List all the VMs and VM ID / GUID of each Virtual machine.
Get-Vm | FT Vmname, Vmid 

################################################################################################################################################################################

# Get status of each Virtual Machine, CPU Usage, State , Memory Assigned, Uptime , Status
Get-Vm 

################################################################################################################################################################################
